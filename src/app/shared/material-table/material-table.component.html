<div class="mo-flex mo-items-end mo-gap-3 mo-justify-between mo-mb-4">
  <ng-content select="[tableHeader]"></ng-content>

  @if (defaultSearch) {
  <mat-form-field appearance="outline" class="sm">
    <mat-icon class="mo-text-[18px]" matPrefix>search</mat-icon>
    <mat-label>{{'members.search' | translate}}</mat-label>
    <input matInput (keyup)="applyFilter($event)">
  </mat-form-field>
  }

</div>

<div class="card">
  <div class="table-responsive">
    <table mat-table [dataSource]="dataSource" matSort>

      @for (col of cols; track col) {
      <ng-container [matColumnDef]="col.key">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          @if (col.key != 'actions') {
          <span>{{col.label}}</span>
          }
          @if (col.key === 'actions') {
          <button type="menu" mat-button><mat-icon>{{col.label}}</mat-icon></button>
          }
        </th>
        <td mat-cell *matCellDef="let row">
          @if (col.conditions) {
          @for (c of col.conditions; track c) {
          <span [ngClass]="[
                    row[c.key] != row[col.key] ? 'mo-hidden' : '',
                    row[c.key] === c.value && row[c.key] != row[col.key] ? c.classes : ''
                    ]">
            {{row[col.key]}}
          </span>
          }
          }
          @if (!col.conditions) {
          @if (col.colType === colsTypes.IMAGE) {
          <div class="mo-rounded-md mo-mx-auto mo-w-fit mo-overflow-hidden">
            <img width="42" height="42" [src]="row[col.key]" alt="">
          </div>
          } @else if (col.colType === colsTypes.DATE) {
          {{row[col.key] | date}}
          }@else if (col.colType === colsTypes.NUMBER) {
          {{row[col.key] | number}}
          }@else if (col.colType === colsTypes.DATETIME) {
          {{row[col.key] | date : 'MMM d, y, h:mm a'}}
          }@else if (col.colType === colsTypes.ICON) {
          @if(row[col.key]){
          <mat-icon [matTooltip]="col.tooltip" [ngClass]="col.iconClass">{{col.icon}}</mat-icon>
          }
          } @else {
          <span [ngClass]="col.iconClass">{{row[col.key]}}</span>
          }
          }
          @if (col.subLabel) {
          <div class="mo-text-muted mo-text-xs">{{row[col.subLabel]}}</div>
          }
          @if (col.key === 'actions') {
          <button mat-button [matMenuTriggerFor]="menu">
            <mat-icon>more_horiz</mat-icon>
          </button>
          <mat-menu #menu="matMenu">
            @for (action of actions; track action) {
            <button (click)="getAction.emit({actionName: action.actionId, data:row})" mat-menu-item>@if (action.icon) {
              <mat-icon>{{action.icon}}</mat-icon>
              }
              {{action.name}}</button>
            }
          </mat-menu>
          }
          @if (col.key === 'action') {
          <button mat-icon-button
            (click)="$event.stopPropagation(); getAction.emit({actionName: col.key, data:row})"><mat-icon
              [ngClass]="col.iconClass">{{col.icon}}</mat-icon></button>
          }
        </td>
      </ng-container>
      }

      <!-- <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef>
          <button type="menu" mat-button>
            <mat-icon>settings</mat-icon>
          </button>
        </th>
        <td mat-cell *matCellDef="let row">
          <ng-content select="[optionMenu]"></ng-content>
        </td>
      </ng-container> -->

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr (click)="onRowClick(row)" mat-row class="mo-cursor-pointer hover:mo-bg-neutral-200"
        *matRowDef="let row; columns: displayedColumns;"></tr>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="4">
          <p class="mo-text-sm mo-text-muted mo-py-3">{{'members.noData' | translate}}</p>
        </td>
      </tr>
    </table>
  </div>
  <mat-paginator (page)="onPaginationChange($event)" [pageSizeOptions]="[5, 10, 25, 100]" [length]="totalElements"
    [pageSize]="pageSize" aria-label="Select page"></mat-paginator>

</div>