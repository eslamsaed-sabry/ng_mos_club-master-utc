<h5 mat-dialog-title class="mo-font-bold mo-capitalize">{{data.type}} Membership

  <div class="mo-font-bold mo-text-center">
    <label class="fs-6">{{'common.yourCurrentBranch' | translate}}{{branchName}}</label>
  </div>
</h5>

<form #upgradeModal="ngForm" (ngSubmit)="submit(upgradeModal)">
  <div mat-dialog-content>
    <div class="row">
      <div class="col-12">
        <mat-form-field appearance="outline" class="mo-w-full">
          <mat-label>{{'reports.table.date' | translate}}</mat-label>
          <input matInput type="datetime-local" [(ngModel)]="paymentDate" name="paymentDate" required>
        </mat-form-field>
      </div>

      <div class="col-md-8 col-12">
        <mat-form-field class="mo-w-full" appearance="outline">
          <mat-label>{{'reports.table.currentPackage' | translate}}</mat-label>
          <mat-select [(ngModel)]="data.membership.packageId" name="currentPackageId" disabled>
            @for (p of packages; track p) {
              <mat-option [value]="p.id">{{p.nameEng}}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col-md-4 col-12">
        <mat-form-field class="mo-w-full" appearance="outline">
          <mat-label>{{'members.price'| translate}}</mat-label>
          <input matInput type="number" [(ngModel)]="data.membership.price" name="price" disabled />
        </mat-form-field>
      </div>

      <div class="col-md-8 col-12">
        <mat-form-field class="mo-w-full" appearance="outline">
          <mat-label class="mo-capitalize">{{data.type}} Package</mat-label>
          <mat-select [(ngModel)]="packageId" name="packageId" (selectionChange)="onSelectPackage()" required>
            @for (p of packages; track p) {
              <mat-option [value]="p.id">{{p.nameEng}}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>

      <div class="col-md-4 col-12">
        <mat-form-field class="mo-w-full" appearance="outline">
          <mat-label>{{'members.price'| translate}}</mat-label>
          <input matInput type="number" [min]="minPrice" [max]="maxPrice" (blur)="getPriceDiff()"
            [(ngModel)]="newPackagePrice" name="newPackagePrice" />
          </mat-form-field>
        </div>

        <div class="col-12">
          <mat-form-field class="mo-w-full" appearance="outline">
            <mat-label>{{'reports.table.difference'| translate}}</mat-label>
            <input matInput disabled type="number" [(ngModel)]="difference" name="difference" />
          </mat-form-field>
        </div>

        @if (data.type === 'downgrade') {
          <div class="col-12">
            <mat-form-field class="mo-w-full" appearance="outline">
              <mat-label>{{'members.remainingAmount'| translate}}</mat-label>
              <input matInput disabled type="number" [(ngModel)]="data.membership.debts" name="remainingMoney" />
            </mat-form-field>
          </div>
        }

        @if (data.type === 'downgrade') {
          <div class="col-12">
            <mat-form-field class="mo-w-full" appearance="outline">
              <mat-label>{{'reports.table.refundAmount' | translate}}</mat-label>
              <input matInput disabled type="number" [(ngModel)]="refundAmount" name="refundAmount" />
            </mat-form-field>
          </div>
        }

        @if (data.type === 'upgrade') {
          <div class="col-12">
            <mat-form-field class="mo-w-full" appearance="outline">
              <mat-label>{{'reports.table.amountPaidCash' | translate}}</mat-label>
              <input matInput [(ngModel)]="amountPaidCash" [required]="!amountPaidVisa" name="AmountPaidCash" />
            </mat-form-field>
          </div>
        }

        @if (data.type === 'upgrade') {
          <div class="col-12">
            <mat-form-field class="mo-w-full" appearance="outline">
              <mat-label>{{'reports.table.amountPaidVisa' | translate}}</mat-label>
              <input matInput [(ngModel)]="amountPaidVisa" name="AmountPaidVisa" [required]="!amountPaidCash" />
            </mat-form-field>
          </div>
        }

        @if (amountPaidVisa) {
          <div class="col-12">
            <mat-form-field class="mo-w-full" appearance="outline">
              <mat-label>{{'members.visaType' | translate}}</mat-label>
              <mat-select [(ngModel)]="visaTypeId" name="visaTypeId" required>
                @for (v of visaTypes; track v) {
                  <mat-option [value]="v.id">{{v.name}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          </div>
        }

        @if (isShowReceiptNo) {
          <div class="col-12">
            <mat-form-field class="mo-w-full" appearance="outline">
              <mat-label>{{'members.receiptNo' | translate}}</mat-label>
              <input matInput [(ngModel)]="receiptNo" name="receiptNo" required />
            </mat-form-field>
          </div>
        }

      </div>
    </div>

    <div class="mo-text-end mo-mt-3" mat-dialog-actions>
      <button type="button" (click)="dismiss()" mat-button>{{'members.cancel' | translate}}</button>
      <button type="submit" class="mo-capitalize" mat-raised-button color="primary">{{data.type}}</button>
    </div>
  </form>